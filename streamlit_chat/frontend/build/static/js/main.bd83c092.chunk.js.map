{"version":3,"sources":["stChat.tsx","index.tsx"],"names":["Chat","componentDidUpdate","Streamlit","setFrameHeight","componentDidMount","render","avatarUrl","props","args","isUser","isPicture","avatarStyle","seed","message","answers","startsWith","theme","Avatar","styled","img","border","borderRadius","height","width","margin","Message","div","display","background","secondaryBackgroundColor","padding","maxWidth","css","AnswerBubble","marginBottom","marginRight","opacity","MessageDiv","fontFamily","font","flexFlow","Img","maxHeight","BubbleImg","marginLeft","messages","Array","isArray","map","m","i","msg","onLoad","key","src","alt","draggable","StreamlitComponentBase","withStreamlitConnection","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.bd83c092.chunk.js","sourcesContent":["import {\n  StreamlitComponentBase,\n  withStreamlitConnection,\n  Streamlit\n} from \"streamlit-component-lib\"\nimport React, { ReactNode } from \"react\"\nimport styled from '@emotion/styled'\nimport { css } from '@emotion/react'\n\n\nclass Chat extends StreamlitComponentBase {\n  public componentDidUpdate = () => {\n    Streamlit.setFrameHeight()\n  }\n\n  public componentDidMount = () => {\n    Streamlit.setFrameHeight()\n  }\n\n  public render = (): ReactNode => {\n    const { isUser, isPicture, avatarStyle, seed, message, answers } = this.props.args;\n    let avatarUrl\n    if (avatarStyle.startsWith(\"data:\")) {\n      avatarUrl = avatarStyle\n    } else {\n      avatarUrl = `https://avatars.dicebear.com/api/${avatarStyle}/${seed}.svg`\n    }\n\n    // Streamlit sends us a theme object via props that we can use to ensure\n    // that our component has visuals that match the active theme in a\n    // streamlit app.\n    const { theme } = this.props\n\n    // Maintain compatibility with older versions of Streamlit that don't send\n    // a theme object.\n    if (!theme) {\n      return <div>Theme is undefined, please check streamlit version.</div>\n    }\n\n    // styles for the avatar image\n    const Avatar = styled.img({\n      border: `1px solid transparent`,\n      borderRadius: '50%',\n      height: '2.5rem',\n      width: '2.5rem',\n      margin: 0\n    })\n\n    // styles for the message box\n    const Message = styled.div({\n      display: 'block',\n      background: theme.secondaryBackgroundColor,\n      border: '1px solid transparent',\n      borderRadius: '1px 10px 10px 1px',\n      padding: '10px 14px',\n      margin: '1px 5px',\n      maxWidth: '70%',\n      width: 'fit-content',\n    }, (props: { isUser: boolean }) => {\n      return css`\n        &:first-child {\n          border-radius: ${props.isUser ? '10px 1px 1px 10px' : '1px 10px 10px 1px'};\n        }\n        &:last-child {\n          border-radius: ${props.isUser ? '10px 1px 10px 10px' : '1px 10px 10px 10px'};\n        }\n        & * {\n          max-width: 100%;\n        }\n      `\n    })\n    const AnswerBubble = styled.div({\n      display: 'block',\n      background: theme.secondaryBackgroundColor,\n      border: '1px solid transparent',\n      borderRadius: '10px 10px 10px 10px',\n      padding: '10px 14px',\n      margin: '1px 5px',\n      maxWidth: '70%',\n      width: 'fit-content',\n      marginBottom: '-10px',\n      marginRight: '10px !important',\n      opacity: '0.5'\n    }, () => {\n      return css`\n        & * {\n          max-width: 100%;\n        }\n      `\n    })\n\n    const MessageDiv = styled.div({\n      width: '100%',\n    }, (props: {isUser: boolean}) => {\n      if (props.isUser) {\n        return css`\n          & div {\n            margin-left: auto;\n            margin-right: 0;\n          }\n        `\n      }\n      return css``\n    })\n\n    // styles for the container\n    const Chat = styled.div({\n      fontFamily: `${theme.font}, 'Segoe UI', 'Roboto', sans-serif`, \n      height: 'auto',\n      margin: 0,\n      width: '100%',\n      flexFlow: 'column'\n    }, \n    (props: {isUser: boolean}) => {  // specific styles\n      if (props.isUser){\n        return css`\n          text-align: right;\n        `\n      }\n      return css``\n    })\n\n    const Img = styled.img({\n      maxWidth: '70%',\n      maxHeight: '350px',\n      display: 'block',\n      borderRadius: '1px 10px 10px 1px',\n      margin: '1px 5px'\n    }, (props: { isUser: boolean }) => {\n      return css`\n        ${props.isUser ? 'margin-left: auto;' : 'margin-right: auto;'}\n        &:first-child {\n          border-radius: ${props.isUser ? '10px 1px 1px 10px' : '1px 10px 10px 1px'};\n        }\n        &:last-child {\n          border-radius: ${props.isUser ? '10px 1px 10px 10px' : '1px 10px 10px 10px'};\n        }\n      `\n    })\n    const BubbleImg = styled.img({\n      maxWidth: '70%',\n      maxHeight: '350px',\n      display: 'block',\n      borderRadius: '10px 10px 10px 10px',\n      margin: '1px 5px',\n      marginBottom: '-10px',\n      marginRight: '10px !important',\n      opacity: '0.6',\n      marginLeft: 'auto'\n    })\n\n    // The message variable could be an array of strings or a single string.\n    // If it's an array, we'll render each element as a separate message.\n    // If it's a string, we'll render it as a single message.\n    let messages: ReactNode[] | ReactNode = []\n    if (Array.isArray(message)) {\n      messages = message.map((m: string, i: number) => {\n        let msg\n        if (isPicture[i])\n          msg = <Img onLoad={() => Streamlit.setFrameHeight()} key={i} src={m} isUser={isUser} />\n        else\n          msg = <Message isUser={isUser} key={i}>{m}</Message>\n\n        if (answers != null && i in answers) {\n          let replied_to\n          // TODO: this is not safe at all\n          if (!answers[i].startsWith(\"data:image/jpeg;base64\")) {\n            replied_to = <AnswerBubble key={\"answers\" + i}>{answers[i]}</AnswerBubble>\n          } else {\n            replied_to = <BubbleImg onLoad={() => Streamlit.setFrameHeight()} key={\"bubble_image\" + i} src={answers[i]} />\n          }\n\n          msg = [\n            replied_to,\n            msg\n          ]\n        }\n\n        return msg\n      })\n    } else {\n      if (isPicture)\n        messages = <Img onLoad={() => Streamlit.setFrameHeight()} src={message} isUser={isUser} key=\"0\" />\n      else\n        messages = <Message isUser={isUser} key=\"0\">{message}</Message>\n    }\n\n    return (\n      <Chat isUser={isUser}>\n        <Avatar src={avatarUrl} alt=\"profile\" draggable=\"false\"/>\n        <MessageDiv isUser={isUser}>\n          {messages}\n        </MessageDiv>\n      </Chat>\n    )\n  }\n}\n\nexport default withStreamlitConnection(Chat);\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport Chat from \"./stChat\"\n\nReactDOM.render(\n  <React.StrictMode>\n    <Chat />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n)\n"],"sourceRoot":""}